<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Dice Game</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    font-family: 'Arial', sans-serif;
    text-align: center;
    padding: 20px;
    min-height: 100vh;
    color: white;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
}

.header {
    margin-bottom: 20px;
}

h1 {
    color: gold;
    font-size: 2.5em;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    margin-bottom: 10px;
}

.theme-selector {
    margin: 10px 0;
}

.theme-btn {
    padding: 8px 15px;
    margin: 0 5px;
    background-color: #2d2d2d;
    color: gold;
    border: 2px solid gold;
    cursor: pointer;
    font-weight: bold;
    border-radius: 5px;
    transition: all 0.3s;
}

.theme-btn:hover {
    background-color: gold;
    color: black;
    transform: scale(1.05);
}

.theme-btn.active {
    background-color: gold;
    color: black;
}

.main-content {
    display: grid;
    grid-template-columns: 1fr 2fr 1fr;
    gap: 20px;
    margin-top: 20px;
}

.sidebar {
    background-color: rgba(13, 13, 13, 0.8);
    border: 3px solid gold;
    padding: 20px;
    border-radius: 10px;
}

.game-area {
    background-color: rgba(13, 13, 13, 0.8);
    border: 3px solid gold;
    padding: 30px;
    border-radius: 10px;
}

.mode-selector {
    margin: 20px 0;
}

.mode-btn {
    padding: 10px 20px;
    margin: 5px;
    background-color: #2d2d2d;
    color: gold;
    border: 2px solid gold;
    cursor: pointer;
    font-weight: bold;
    border-radius: 5px;
    transition: all 0.3s;
}

.mode-btn:hover {
    background-color: #3d3d3d;
    transform: translateY(-2px);
}

.mode-btn.active {
    background-color: green;
    color: white;
    border-color: white;
}

.dice-container {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 30px 0;
    flex-wrap: wrap;
}

.dice {
    font-size: 60px;
    background-color: white;
    color: black;
    width: 100px;
    height: 100px;
    line-height: 100px;
    border: 3px solid gold;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    position: relative;
    transition: all 0.3s;
}

.dice.rolling {
    animation: spin3d 0.5s ease;
}

@keyframes spin3d {
    0% { transform: rotateY(0deg) rotateX(0deg); }
    50% { transform: rotateY(180deg) rotateX(180deg); }
    100% { transform: rotateY(360deg) rotateX(360deg); }
}

.dice-dots {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    padding: 10px;
    width: 100%;
    height: 100%;
}

.dot {
    width: 15px;
    height: 15px;
    background-color: black;
    border-radius: 50%;
    margin: auto;
}

.numbers {
    margin: 20px 0;
}

.numbers button {
    width: 60px;
    height: 60px;
    margin: 5px;
    font-size: 24px;
    font-weight: bold;
    background-color: #2d2d2d;
    color: gold;
    border: 2px solid gold;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s;
}

.numbers button:hover {
    background-color: #3d3d3d;
    transform: scale(1.1);
}

.numbers button.picked {
    background-color: red;
    color: white;
    transform: scale(1.15);
}

.controls {
    margin: 20px 0;
}

.btn {
    padding: 12px 25px;
    margin: 5px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    border: 2px solid gold;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s;
    text-transform: uppercase;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255,215,0,0.3);
}

.roll-btn {
    background-color: green;
}

.reset-btn {
    background-color: darkred;
}

.undo-btn {
    background-color: orange;
}

.message {
    color: white;
    padding: 15px;
    margin: 20px 0;
    min-height: 50px;
    border-radius: 8px;
    font-size: 18px;
    font-weight: bold;
}

.win {
    background-color: green;
    color: gold;
    animation: pulse 0.5s;
}

.lose {
    background-color: darkred;
    animation: shake 0.5s;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}

.stats {
    margin-top: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 10px;
}

.stat-box {
    background-color: #2d2d2d;
    border: 2px solid gold;
    padding: 15px;
    border-radius: 8px;
}

.stat-label {
    color: gold;
    font-size: 12px;
    margin-bottom: 5px;
}

.stat-num {
    color: gold;
    font-size: 24px;
    font-weight: bold;
}

.achievements {
    margin-top: 20px;
}

.achievement {
    background-color: #2d2d2d;
    border: 2px solid #666;
    padding: 10px;
    margin: 10px 0;
    border-radius: 8px;
    transition: all 0.3s;
}

.achievement.unlocked {
    border-color: gold;
    background-color: rgba(255, 215, 0, 0.1);
}

.achievement-icon {
    font-size: 30px;
    margin-bottom: 5px;
}

.achievement-name {
    color: gold;
    font-weight: bold;
    font-size: 14px;
}

.achievement-desc {
    color: #ccc;
    font-size: 12px;
}

.leaderboard {
    margin-top: 20px;
}

.leaderboard-entry {
    background-color: #2d2d2d;
    border: 1px solid gold;
    padding: 10px;
    margin: 5px 0;
    border-radius: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.leaderboard-rank {
    color: gold;
    font-weight: bold;
    font-size: 20px;
    margin-right: 10px;
}

.leaderboard-score {
    color: gold;
    font-weight: bold;
}

.history {
    margin-top: 20px;
}

.history-item {
    background-color: #2d2d2d;
    border: 1px solid #666;
    padding: 8px;
    margin: 5px 0;
    border-radius: 5px;
    font-size: 14px;
}

.history-item.win-history {
    border-color: green;
}

.history-item.lose-history {
    border-color: red;
}

.powerups {
    margin: 20px 0;
}

.powerup-btn {
    padding: 10px 15px;
    margin: 5px;
    background-color: purple;
    color: white;
    border: 2px solid gold;
    cursor: pointer;
    font-weight: bold;
    border-radius: 5px;
    transition: all 0.3s;
}

.powerup-btn:hover {
    background-color: darkviolet;
    transform: scale(1.05);
}

.powerup-btn:disabled {
    background-color: #666;
    cursor: not-allowed;
    opacity: 0.5;
}

.timer {
    font-size: 48px;
    color: gold;
    margin: 20px 0;
    font-weight: bold;
}

.progress-bar {
    width: 100%;
    height: 30px;
    background-color: #2d2d2d;
    border: 2px solid gold;
    border-radius: 15px;
    overflow: hidden;
    margin: 20px 0;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, gold, orange);
    transition: width 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    color: black;
    font-weight: bold;
}

.confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background-color: gold;
    position: absolute;
    animation: confetti-fall 3s linear;
}

@keyframes confetti-fall {
    to {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
    }
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.8);
}

.modal-content {
    background-color: #1a1a2e;
    margin: 5% auto;
    padding: 30px;
    border: 3px solid gold;
    border-radius: 10px;
    width: 80%;
    max-width: 600px;
    max-height: 80vh;
    overflow-y: auto;
}

.close {
    color: gold;
    float: right;
    font-size: 35px;
    font-weight: bold;
    cursor: pointer;
}

.close:hover {
    color: white;
}

.tab-buttons {
    display: flex;
    justify-content: center;
    margin: 20px 0;
    flex-wrap: wrap;
}

.tab-btn {
    padding: 10px 20px;
    margin: 5px;
    background-color: #2d2d2d;
    color: gold;
    border: 2px solid gold;
    cursor: pointer;
    font-weight: bold;
    border-radius: 5px;
}

.tab-btn.active {
    background-color: gold;
    color: black;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.player-turn {
    background-color: #2d2d2d;
    border: 2px solid gold;
    padding: 15px;
    margin: 15px 0;
    border-radius: 8px;
}

.player-turn.active-player {
    border-color: lime;
    box-shadow: 0 0 20px rgba(0,255,0,0.5);
}

.difficulty-selector {
    margin: 20px 0;
}

.sound-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: #2d2d2d;
    color: gold;
    border: 2px solid gold;
    padding: 10px 15px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 20px;
    z-index: 100;
}

.keyboard-hint {
    color: #888;
    font-size: 12px;
    margin-top: 10px;
}

.streak-display {
    background: linear-gradient(135deg, red, orange, yellow);
    color: black;
    padding: 10px;
    border-radius: 8px;
    font-weight: bold;
    margin: 10px 0;
    animation: glow 2s infinite;
}

@keyframes glow {
    0%, 100% { box-shadow: 0 0 10px rgba(255,215,0,0.5); }
    50% { box-shadow: 0 0 30px rgba(255,215,0,1); }
}

/* Theme variations */
body.light-theme {
    background: linear-gradient(135deg, #f0f0f0 0%, #e0e0e0 100%);
    color: black;
}

body.light-theme .game-area,
body.light-theme .sidebar {
    background-color: rgba(255, 255, 255, 0.9);
    border-color: #333;
}

body.light-theme h1,
body.light-theme .stat-label,
body.light-theme .stat-num {
    color: #333;
}

body.neon-theme {
    background: linear-gradient(135deg, #000000 0%, #1a0033 100%);
}

body.neon-theme .game-area,
body.neon-theme .sidebar {
    border-color: #ff00ff;
    box-shadow: 0 0 20px rgba(255,0,255,0.5);
}

body.neon-theme h1 {
    color: #ff00ff;
    text-shadow: 0 0 10px #ff00ff;
}

@media (max-width: 968px) {
    .main-content {
        grid-template-columns: 1fr;
    }
    
    h1 {
        font-size: 1.8em;
    }
    
    .dice {
        width: 80px;
        height: 80px;
        font-size: 50px;
        line-height: 80px;
    }
}

.share-btn {
    background-color: #1DA1F2;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    margin: 10px 5px;
}

.share-btn:hover {
    background-color: #0d8bd9;
}

.daily-challenge {
    background: linear-gradient(135deg, purple, darkviolet);
    border: 2px solid gold;
    padding: 15px;
    border-radius: 10px;
    margin: 15px 0;
}

.challenge-timer {
    color: gold;
    font-size: 20px;
    font-weight: bold;
}
</style>
</head>
<body>
<button class="sound-toggle" onclick="toggleSound()" id="soundBtn">üîä</button>

<div class="container">
    <div class="header">
        <h1>üé≤ Ultimate Dice Game üé≤</h1>
        <div class="theme-selector">
            <button class="theme-btn active" onclick="setTheme('dark')">Dark</button>
            <button class="theme-btn" onclick="setTheme('light')">Light</button>
            <button class="theme-btn" onclick="setTheme('neon')">Neon</button>
        </div>
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="showTab('play')">Play</button>
            <button class="tab-btn" onclick="showTab('stats')">Statistics</button>
            <button class="tab-btn" onclick="showTab('achievements')">Achievements</button>
            <button class="tab-btn" onclick="showTab('leaderboard')">Leaderboard</button>
            <button class="tab-btn" onclick="showTab('tutorial')">Tutorial</button>
        </div>
    </div>

    <div id="playTab" class="tab-content active">
        <div class="main-content">
            <!-- Left Sidebar -->
            <div class="sidebar">
                <h2 style="color: gold; margin-bottom: 15px;">Game History</h2>
                <div class="history" id="history">
                    <p style="color: #888;">No rolls yet</p>
                </div>
            </div>

            <!-- Main Game Area -->
            <div class="game-area">
                <div class="mode-selector">
                    <button class="mode-btn active" onclick="setMode('single')">Single Player</button>
                    <button class="mode-btn" onclick="setMode('two')">Two Players</button>
                    <button class="mode-btn" onclick="setMode('time')">Time Challenge</button>
                </div>

                <div class="difficulty-selector" id="difficultySelector">
                    <label style="color: gold;">Difficulty:</label>
                    <select id="difficulty" onchange="setDifficulty()" style="padding: 8px; margin: 10px; font-size: 16px; background-color: #2d2d2d; color: gold; border: 2px solid gold; border-radius: 5px;">
                        <option value="easy">Easy (1 die, +10/-2)</option>
                        <option value="medium">Medium (2 dice, +20/-5)</option>
                        <option value="hard">Hard (3 dice, +30/-10)</option>
                    </select>
                </div>

                <div class="daily-challenge" id="dailyChallenge">
                    <h3 style="color: gold;">üåü Daily Challenge üåü</h3>
                    <p style="color: white;">Reach 100 points with a 5+ win streak!</p>
                    <div class="challenge-timer" id="challengeTimer">23:45:12 remaining</div>
                </div>

                <div id="twoPlayerDisplay" style="display: none;">
                    <div class="player-turn active-player" id="player1Display">
                        <h3 style="color: gold;">Player 1</h3>
                        <p>Score: <span id="p1Score">0</span> | Wins: <span id="p1Wins">0</span></p>
                    </div>
                    <div class="player-turn" id="player2Display">
                        <h3 style="color: gold;">Player 2</h3>
                        <p>Score: <span id="p2Score">0</span> | Wins: <span id="p2Wins">0</span></p>
                    </div>
                </div>

                <div id="timeChallengeDisplay" style="display: none;">
                    <div class="timer" id="timer">60</div>
                    <p style="color: gold;">Make as many correct guesses as possible!</p>
                </div>

                <div id="streakDisplay" style="display: none;" class="streak-display">
                    üî• Win Streak: <span id="streakCount">0</span> üî•
                </div>

                <div class="progress-bar" id="progressBar" style="display: none;">
                    <div class="progress-fill" id="progressFill" style="width: 0%;">0/10</div>
                </div>

                <div class="dice-container" id="diceContainer">
                    <div class="dice" id="dice1">
                        <div class="dice-dots" id="dots1"></div>
                    </div>
                </div>

                <p style="color: gold; font-size: 18px; margin: 15px 0;">Pick your number(s):</p>
                <div class="numbers" id="numbers">
                    <button onclick="pick(1)">1</button>
                    <button onclick="pick(2)">2</button>
                    <button onclick="pick(3)">3</button>
                    <button onclick="pick(4)">4</button>
                    <button onclick="pick(5)">5</button>
                    <button onclick="pick(6)">6</button>
                </div>
                <p class="keyboard-hint">üí° Tip: Use keyboard 1-6 to pick, SPACE to roll, R to reset</p>

                <div class="powerups">
                    <h3 style="color: gold;">Power-ups (Cost 20 pts each)</h3>
                    <button class="powerup-btn" onclick="usePowerup('reveal')" id="revealBtn">üîÆ Reveal Answer</button>
                    <button class="powerup-btn" onclick="usePowerup('double')" id="doubleBtn">üí∞ Double Points (1 roll)</button>
                    <button class="powerup-btn" onclick="usePowerup('shield')" id="shieldBtn">üõ°Ô∏è Loss Shield (1 roll)</button>
                </div>

                <div class="controls">
                    <button class="btn roll-btn" onclick="rollDice()" id="rollBtn">üé≤ ROLL DICE</button>
                    <button class="btn undo-btn" onclick="undoLast()" id="undoBtn" disabled>‚Ü∂ UNDO</button>
                    <button class="btn reset-btn" onclick="resetGame()">üîÑ RESET GAME</button>
                </div>

                <div class="message" id="msg"></div>

                <div class="stats" id="mainStats">
                    <div class="stat-box">
                        <div class="stat-label">SCORE</div>
                        <div class="stat-num" id="score">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">WINS</div>
                        <div class="stat-num" id="wins">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">LOSSES</div>
                        <div class="stat-num" id="losses">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">WIN STREAK</div>
                        <div class="stat-num" id="streak">0</div>
                    </div>
                </div>

                <button class="share-btn" onclick="shareScore()">üì± Share Score</button>
            </div>

            <!-- Right Sidebar -->
            <div class="sidebar">
                <h2 style="color: gold; margin-bottom: 15px;">Achievements</h2>
                <div class="achievements" id="achievementsSidebar">
                    <!-- Achievements will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <div id="statsTab" class="tab-content">
        <div class="game-area" style="max-width: 800px; margin: 0 auto;">
            <h2 style="color: gold; margin-bottom: 20px;">üìä Detailed Statistics</h2>
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-label">TOTAL ROLLS</div>
                    <div class="stat-num" id="totalRolls">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">WIN RATE</div>
                    <div class="stat-num" id="winRate">0%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">AVG SCORE</div>
                    <div class="stat-num" id="avgScore">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">BEST STREAK</div>
                    <div class="stat-num" id="bestStreak">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">HIGHEST SCORE</div>
                    <div class="stat-num" id="highScore">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">GAMES PLAYED</div>
                    <div class="stat-num" id="gamesPlayed">0</div>
                </div>
            </div>
            <div style="margin-top: 30px;">
                <h3 style="color: gold;">Number Frequency</h3>
                <canvas id="statsChart" style="max-width: 600px; margin: 20px auto;"></canvas>
            </div>
        </div>
    </div>

    <div id="achievementsTab" class="tab-content">
        <div class="game-area" style="max-width: 800px; margin: 0 auto;">
            <h2 style="color: gold; margin-bottom: 20px;">üèÜ Achievements</h2>
            <div id="achievementsList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                <!-- Achievements will be populated here -->
            </div>
        </div>
    </div>

    <div id="leaderboardTab" class="tab-content">
        <div class="game-area" style="max-width: 800px; margin: 0 auto;">
            <h2 style="color: gold; margin-bottom: 20px;">üëë Leaderboard</h2>
            <p style="color: #ccc; margin-bottom: 20px;">Top 10 High Scores (Saved in your browser)</p>
            <div class="leaderboard" id="leaderboardList">
                <!-- Leaderboard entries will be populated here -->
            </div>
        </div>
    </div>

    <div id="tutorialTab" class="tab-content">
        <div class="game-area" style="max-width: 800px; margin: 0 auto;">
            <h2 style="color: gold; margin-bottom: 20px;">üìñ How to Play</h2>
            <div style="text-align: left; color: white; line-height: 1.8;">
                <h3 style="color: gold; margin-top: 20px;">Basic Rules:</h3>
                <ul>
                    <li>Pick a number between 1-6</li>
                    <li>Click ROLL DICE to roll</li>
                    <li>If you guess correctly, you WIN and earn points!</li>
                    <li>If you guess wrong, you LOSE and lose points</li>
                </ul>

                <h3 style="color: gold; margin-top: 20px;">Difficulty Levels:</h3>
                <ul>
                    <li><strong>Easy:</strong> 1 die, +10 points for win, -2 for loss</li>
                    <li><strong>Medium:</strong> 2 dice, +20 points for win, -5 for loss</li>
                    <li><strong>Hard:</strong> 3 dice, +30 points for win, -10 for loss</li>
                </ul>

                <h3 style="color: gold; margin-top: 20px;">Game Modes:</h3>
                <ul>
                    <li><strong>Single Player:</strong> Play at your own pace and build your score</li>
                    <li><strong>Two Player:</strong> Take turns with a friend and compete for the highest score</li>
                    <li><strong>Time Challenge:</strong> Make as many correct guesses as possible in 60 seconds</li>
                </ul>

                <h3 style="color: gold; margin-top: 20px;">Power-ups (Cost 20 points):</h3>
                <ul>
                    <li><strong>üîÆ Reveal Answer:</strong> See the result before committing your guess</li>
                    <li><strong>üí∞ Double Points:</strong> Earn double points on your next win</li>
                    <li><strong>üõ°Ô∏è Loss Shield:</strong> Protect yourself from losing points on your next loss</li>
                </ul>

                <h3 style="color: gold; margin-top: 20px;">Win Streaks & Bonuses:</h3>
                <ul>
                    <li>Win 3 games in a row: +5 bonus points</li>
                    <li>Win 5 games in a row: +15 bonus points</li>
                    <li>Win 10 games in a row: +50 bonus points</li>
                </ul>

                <h3 style="color: gold; margin-top: 20px;">Keyboard Shortcuts:</h3>
                <ul>
                    <li><strong>1-6:</strong> Pick numbers</li>
                    <li><strong>SPACE:</strong> Roll dice</li>
                    <li><strong>R:</strong> Reset game</li>
                    <li><strong>U:</strong> Undo last roll</li>
                </ul>

                <h3 style="color: gold; margin-top: 20px;">Tips:</h3>
                <ul>
                    <li>Build up points before buying power-ups</li>
                    <li>Use the Reveal power-up strategically on higher difficulty</li>
                    <li>Win streaks give big bonuses - try to keep them going!</li>
                    <li>Check achievements for goals to work towards</li>
                    <li>Try the daily challenge for extra rewards</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
// Game State
let gameState = {
    score: 0,
    wins: 0,
    losses: 0,
    picked: [],
    difficulty: 'easy',
    numDice: 1,
    winPoints: 10,
    losePoints: 2,
    mode: 'single',
    currentPlayer: 1,
    player1: { score: 0, wins: 0 },
    player2: { score: 0, wins: 0 },
    streak: 0,
    bestStreak: 0,
    powerups: {
        reveal: false,
        double: false,
        shield: false
    },
    history: [],
    lastState: null,
    soundEnabled: true,
    totalRolls: 0,
    gamesPlayed: 0,
    numberFrequency: [0,0,0,0,0,0],
    timeChallenge: {
        active: false,
        timeLeft: 60,
        interval: null
    }
};

// Achievements
const achievements = [
    { id: 'first_win', name: 'First Victory', desc: 'Win your first game', icon: 'üéØ', unlocked: false },
    { id: 'win_streak_5', name: 'Hot Streak', desc: 'Win 5 games in a row', icon: 'üî•', unlocked: false },
    { id: 'win_streak_10', name: 'Unstoppable', desc: 'Win 10 games in a row', icon: '‚ö°', unlocked: false },
    { id: 'score_100', name: 'Century', desc: 'Reach 100 points', icon: 'üíØ', unlocked: false },
    { id: 'score_500', name: 'High Roller', desc: 'Reach 500 points', icon: 'üé∞', unlocked: false },
    { id: 'total_wins_50', name: 'Veteran', desc: 'Win 50 games total', icon: 'üèÖ', unlocked: false },
    { id: 'total_wins_100', name: 'Master', desc: 'Win 100 games total', icon: 'üëë', unlocked: false },
    { id: 'use_powerup', name: 'Power Player', desc: 'Use a power-up', icon: '‚ö°', unlocked: false },
    { id: 'complete_hard', name: 'Hard Mode Hero', desc: 'Win on hard difficulty', icon: 'üí™', unlocked: false },
    { id: 'win_without_loss', name: 'Perfect Game', desc: 'Win 10 times without a loss', icon: '‚ú®', unlocked: false },
    { id: 'time_challenge', name: 'Speed Demon', desc: 'Score 100+ in time challenge', icon: '‚è±Ô∏è', unlocked: false },
    { id: 'two_player', name: 'Social Gamer', desc: 'Complete a two-player game', icon: 'üë•', unlocked: false }
];

// Load saved data
function loadGame() {
    const saved = localStorage.getItem('ultimateDiceGame');
    if (saved) {
        const data = JSON.parse(saved);
        gameState.bestStreak = data.bestStreak || 0;
        gameState.gamesPlayed = data.gamesPlayed || 0;
        gameState.totalRolls = data.totalRolls || 0;
        gameState.numberFrequency = data.numberFrequency || [0,0,0,0,0,0];
        
        // Load achievements
        if (data.achievements) {
            data.achievements.forEach(id => {
                const ach = achievements.find(a => a.id === id);
                if (ach) ach.unlocked = true;
            });
        }
    }
    updateAchievementsDisplay();
    updateLeaderboard();
}

// Save game
function saveGame() {
    const data = {
        bestStreak: gameState.bestStreak,
        gamesPlayed: gameState.gamesPlayed,
        totalRolls: gameState.totalRolls,
        numberFrequency: gameState.numberFrequency,
        achievements: achievements.filter(a => a.unlocked).map(a => a.id)
    };
    localStorage.setItem('ultimateDiceGame', JSON.stringify(data));
}

// Initialize
loadGame();
updateDiceDisplay();
updateStats();

// Set difficulty
function setDifficulty() {
    const diff = document.getElementById('difficulty').value;
    gameState.difficulty = diff;
    
    if (diff === 'easy') {
        gameState.numDice = 1;
        gameState.winPoints = 10;
        gameState.losePoints = 2;
    } else if (diff === 'medium') {
        gameState.numDice = 2;
        gameState.winPoints = 20;
        gameState.losePoints = 5;
    } else if (diff === 'hard') {
        gameState.numDice = 3;
        gameState.winPoints = 30;
        gameState.losePoints = 10;
    }
    
    updateDiceDisplay();
}

// Set mode
function setMode(mode) {
    gameState.mode = mode;
    
    // Update button states
    document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Show/hide relevant displays
    document.getElementById('twoPlayerDisplay').style.display = mode === 'two' ? 'block' : 'none';
    document.getElementById('timeChallengeDisplay').style.display = mode === 'time' ? 'block' : 'none';
    document.getElementById('mainStats').style.display = mode === 'single' ? 'grid' : 'none';
    
    if (mode === 'time') {
        startTimeChallenge();
    } else if (gameState.timeChallenge.active) {
        stopTimeChallenge();
    }
    
    resetGame();
}

// Start time challenge
function startTimeChallenge() {
    gameState.timeChallenge.active = true;
    gameState.timeChallenge.timeLeft = 60;
    updateTimer();
    
    gameState.timeChallenge.interval = setInterval(() => {
        gameState.timeChallenge.timeLeft--;
        updateTimer();
        
        if (gameState.timeChallenge.timeLeft <= 0) {
            stopTimeChallenge();
            showMessage('Time\'s up! Final score: ' + gameState.score, 'lose');
            if (gameState.score >= 100) {
                unlockAchievement('time_challenge');
            }
        }
    }, 1000);
}

// Stop time challenge
function stopTimeChallenge() {
    gameState.timeChallenge.active = false;
    if (gameState.timeChallenge.interval) {
        clearInterval(gameState.timeChallenge.interval);
    }
}

// Update timer
function updateTimer() {
    document.getElementById('timer').textContent = gameState.timeChallenge.timeLeft;
}

// Update dice display
function updateDiceDisplay() {
    const container = document.getElementById('diceContainer');
    container.innerHTML = '';
    
    for (let i = 0; i < gameState.numDice; i++) {
        const dice = document.createElement('div');
        dice.className = 'dice';
        dice.id = 'dice' + (i + 1);
        dice.innerHTML = '<div class="dice-dots" id="dots' + (i + 1) + '"></div>';
        container.appendChild(dice);
    }
    
    for (let i = 0; i < gameState.numDice; i++) {
        renderDiceDots(1, 'dots' + (i + 1));
    }
}

// Render dice dots
function renderDiceDots(num, elementId) {
    const dotsElement = document.getElementById(elementId);
    if (!dotsElement) return;
    
    dotsElement.innerHTML = '';
    
    const patterns = {
        1: [[1,1]],
        2: [[0,0], [2,2]],
        3: [[0,0], [1,1], [2,2]],
        4: [[0,0], [0,2], [2,0], [2,2]],
        5: [[0,0], [0,2], [1,1], [2,0], [2,2]],
        6: [[0,0], [0,2], [1,0], [1,2], [2,0], [2,2]]
    };
    
    const pattern = patterns[num];
    const grid = Array(9).fill(false);
    
    pattern.forEach(([row, col]) => {
        grid[row * 3 + col] = true;
    });
    
    grid.forEach(hasDot => {
        const dot = document.createElement('div');
        if (hasDot) {
            dot.className = 'dot';
        }
        dotsElement.appendChild(dot);
    });
}

// Pick number
function pick(num) {
    if (gameState.powerups.reveal) return;
    
    const maxPicks = gameState.numDice;
    
    if (gameState.picked.includes(num)) {
        gameState.picked = gameState.picked.filter(n => n !== num);
    } else {
        if (gameState.picked.length < maxPicks) {
            gameState.picked.push(num);
        } else {
            gameState.picked = [num];
        }
    }
    
    updatePickedButtons();
    playSound('pick');
}

// Update picked buttons
function updatePickedButtons() {
    document.querySelectorAll('.numbers button').forEach(btn => {
        btn.classList.remove('picked');
    });
    
    gameState.picked.forEach(num => {
        const btn = document.querySelector(`.numbers button:nth-child(${num})`);
        if (btn) btn.classList.add('picked');
    });
}

// Roll dice
function rollDice() {
    if (gameState.picked.length !== gameState.numDice) {
        showMessage(`Pick ${gameState.numDice} number(s) first!`, 'lose');
        playSound('error');
        return;
    }
    
    // Save state for undo
    gameState.lastState = {
        score: gameState.score,
        wins: gameState.wins,
        losses: gameState.losses,
        streak: gameState.streak,
        player1: {...gameState.player1},
        player2: {...gameState.player2}
    };
    document.getElementById('undoBtn').disabled = false;
    
    // Animate dice
    for (let i = 0; i < gameState.numDice; i++) {
        document.getElementById('dice' + (i + 1)).classList.add('rolling');
    }
    
    playSound('roll');
    
    setTimeout(() => {
        const results = [];
        for (let i = 0; i < gameState.numDice; i++) {
            const result = Math.floor(Math.random() * 6) + 1;
            results.push(result);
            renderDiceDots(result, 'dots' + (i + 1));
            document.getElementById('dice' + (i + 1)).classList.remove('rolling');
            
            // Update frequency
            gameState.numberFrequency[result - 1]++;
        }
        
        gameState.totalRolls++;
        
        // Check if win
        const sortedResults = [...results].sort((a,b) => a-b);
        const sortedPicked = [...gameState.picked].sort((a,b) => a-b);
        const isWin = JSON.stringify(sortedResults) === JSON.stringify(sortedPicked);
        
        let points = isWin ? gameState.winPoints : -gameState.losePoints;
        
        // Apply powerups
        if (gameState.powerups.double && isWin) {
            points *= 2;
            gameState.powerups.double = false;
        }
        if (gameState.powerups.shield && !isWin) {
            points = 0;
            gameState.powerups.shield = false;
        }
        
        // Update score
        if (gameState.mode === 'two') {
            if (gameState.currentPlayer === 1) {
                gameState.player1.score += points;
                if (isWin) gameState.player1.wins++;
            } else {
                gameState.player2.score += points;
                if (isWin) gameState.player2.wins++;
            }
        } else {
            gameState.score += points;
            if (isWin) {
                gameState.wins++;
                gameState.streak++;
                
                // Streak bonuses
                if (gameState.streak === 3) {
                    gameState.score += 5;
                    showMessage('üî• 3-Win Streak! +5 Bonus!', 'win');
                }
                if (gameState.streak === 5) {
                    gameState.score += 15;
                    showMessage('üî•üî• 5-Win Streak! +15 Bonus!', 'win');
                    unlockAchievement('win_streak_5');
                }
                if (gameState.streak === 10) {
                    gameState.score += 50;
                    showMessage('üî•üî•üî• 10-Win Streak! +50 Bonus!', 'win');
                    unlockAchievement('win_streak_10');
                }
                
                if (gameState.streak > gameState.bestStreak) {
                    gameState.bestStreak = gameState.streak;
                }
            } else {
                gameState.losses++;
                gameState.streak = 0;
            }
        }
        
        // Show result
        if (isWin) {
            let msg = `YOU WIN! `;
            if (gameState.powerups.double) msg += `${points} points (doubled!)`;
            else msg += `+${points} points`;
            showMessage(msg, 'win');
            playSound('win');
            createConfetti();
            
            // Check achievements
            if (gameState.wins === 1) unlockAchievement('first_win');
            if (gameState.wins === 50) unlockAchievement('total_wins_50');
            if (gameState.wins === 100) unlockAchievement('total_wins_100');
            if (gameState.score >= 100) unlockAchievement('score_100');
            if (gameState.score >= 500) unlockAchievement('score_500');
            if (gameState.difficulty === 'hard') unlockAchievement('complete_hard');
        } else {
            let msg = `YOU LOSE! `;
            if (gameState.powerups.shield) msg += `Shield protected you!`;
            else msg += `-${Math.abs(points)} points`;
            msg += ` (You picked ${gameState.picked.join(',')}, got ${results.join(',')})`;
            showMessage(msg, 'lose');
            playSound('lose');
        }
        
        // Add to history
        addHistory(isWin, gameState.picked.join(','), results.join(','), points);
        
        // Update displays
        updateStats();
        updateStreakDisplay();
        
        // Two player mode - switch player
        if (gameState.mode === 'two') {
            gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
            updateTwoPlayerDisplay();
        }
        
        // Clear picked
        gameState.picked = [];
        updatePickedButtons();
        
        // Save progress
        saveGame();
        
        // Update leaderboard if game ended
        if (gameState.mode === 'single' && gameState.score <= -50) {
            updateLeaderboard();
            gameState.gamesPlayed++;
            saveGame();
        }
        
    }, 500);
}

// Show message
function showMessage(text, type) {
    const msg = document.getElementById('msg');
    msg.textContent = text;
    msg.className = 'message ' + type;
}

// Update stats
function updateStats() {
    document.getElementById('score').textContent = gameState.score;
    document.getElementById('wins').textContent = gameState.wins;
    document.getElementById('losses').textContent = gameState.losses;
    document.getElementById('streak').textContent = gameState.streak;
    
    // Stats tab
    document.getElementById('totalRolls').textContent = gameState.totalRolls;
    const winRate = gameState.totalRolls > 0 ? Math.round((gameState.wins / gameState.totalRolls) * 100) : 0;
    document.getElementById('winRate').textContent = winRate + '%';
    const avgScore = gameState.gamesPlayed > 0 ? Math.round(gameState.score / gameState.gamesPlayed) : 0;
    document.getElementById('avgScore').textContent = avgScore;
    document.getElementById('bestStreak').textContent = gameState.bestStreak;
    document.getElementById('highScore').textContent = getHighScore();
    document.getElementById('gamesPlayed').textContent = gameState.gamesPlayed;
}

// Update streak display
function updateStreakDisplay() {
    const streakDisplay = document.getElementById('streakDisplay');
    if (gameState.streak >= 3) {
        streakDisplay.style.display = 'block';
        document.getElementById('streakCount').textContent = gameState.streak;
    } else {
        streakDisplay.style.display = 'none';
    }
}

// Update two player display
function updateTwoPlayerDisplay() {
    document.getElementById('p1Score').textContent = gameState.player1.score;
    document.getElementById('p1Wins').textContent = gameState.player1.wins;
    document.getElementById('p2Score').textContent = gameState.player2.score;
    document.getElementById('p2Wins').textContent = gameState.player2.wins;
    
    document.getElementById('player1Display').classList.toggle('active-player', gameState.currentPlayer === 1);
    document.getElementById('player2Display').classList.toggle('active-player', gameState.currentPlayer === 2);
}

// Add to history
function addHistory(isWin, picked, rolled, points) {
    const item = {
        isWin,
        picked,
        rolled,
        points,
        time: new Date().toLocaleTimeString()
    };
    
    gameState.history.unshift(item);
    if (gameState.history.length > 10) gameState.history.pop();
    
    updateHistoryDisplay();
}

// Update history display
function updateHistoryDisplay() {
    const historyDiv = document.getElementById('history');
    if (gameState.history.length === 0) {
        historyDiv.innerHTML = '<p style="color: #888;">No rolls yet</p>';
        return;
    }
    
    historyDiv.innerHTML = gameState.history.map(item => {
        const className = item.isWin ? 'win-history' : 'lose-history';
        const symbol = item.isWin ? '‚úì' : '‚úó';
        return `<div class="history-item ${className}">
            ${symbol} Picked: ${item.picked} | Got: ${item.rolled} | ${item.points > 0 ? '+' : ''}${item.points}
        </div>`;
    }).join('');
}

// Powerups
function usePowerup(type) {
    if (gameState.score < 20) {
        showMessage('Need 20 points to use power-up!', 'lose');
        playSound('error');
        return;
    }
    
    gameState.score -= 20;
    unlockAchievement('use_powerup');
    
    if (type === 'reveal') {
        // Auto-pick the correct answer
        setTimeout(() => {
            const results = [];
            for (let i = 0; i < gameState.numDice; i++) {
                const result = Math.floor(Math.random() * 6) + 1;
                results.push(result);
            }
            gameState.picked = results;
            updatePickedButtons();
            showMessage('üîÆ Revealed! Numbers auto-selected. Click ROLL!', 'win');
            gameState.powerups.reveal = true;
        }, 100);
    } else if (type === 'double') {
        gameState.powerups.double = true;
        showMessage('üí∞ Next win will be DOUBLED!', 'win');
    } else if (type === 'shield') {
        gameState.powerups.shield = true;
        showMessage('üõ°Ô∏è Protected from next loss!', 'win');
    }
    
    playSound('powerup');
    updateStats();
}

// Undo last roll
function undoLast() {
    if (!gameState.lastState) return;
    
    gameState.score = gameState.lastState.score;
    gameState.wins = gameState.lastState.wins;
    gameState.losses = gameState.lastState.losses;
    gameState.streak = gameState.lastState.streak;
    gameState.player1 = {...gameState.lastState.player1};
    gameState.player2 = {...gameState.lastState.player2};
    
    // Remove last history item
    gameState.history.shift();
    
    updateStats();
    updateHistoryDisplay();
    updateTwoPlayerDisplay();
    showMessage('Last roll undone!', 'win');
    
    gameState.lastState = null;
    document.getElementById('undoBtn').disabled = true;
}

// Reset game
function resetGame() {
    if (gameState.mode === 'two' && (gameState.player1.score > 0 || gameState.player2.score > 0)) {
        unlockAchievement('two_player');
    }
    
    if (gameState.score > 0) {
        updateLeaderboard();
        gameState.gamesPlayed++;
    }
    
    gameState.score = 0;
    gameState.wins = 0;
    gameState.losses = 0;
    gameState.picked = [];
    gameState.streak = 0;
    gameState.player1 = { score: 0, wins: 0 };
    gameState.player2 = { score: 0, wins: 0 };
    gameState.currentPlayer = 1;
    gameState.powerups = { reveal: false, double: false, shield: false };
    gameState.history = [];
    gameState.lastState = null;
    
    if (gameState.timeChallenge.active) {
        stopTimeChallenge();
        gameState.timeChallenge.timeLeft = 60;
        startTimeChallenge();
    }
    
    updateStats();
    updateHistoryDisplay();
    updatePickedButtons();
    updateTwoPlayerDisplay();
    updateStreakDisplay();
    showMessage('', '');
    document.getElementById('undoBtn').disabled = true;
    
    for (let i = 0; i < gameState.numDice; i++) {
        renderDiceDots(1, 'dots' + (i + 1));
    }
    
    saveGame();
}

// Achievements
function unlockAchievement(id) {
    const achievement = achievements.find(a => a.id === id);
    if (achievement && !achievement.unlocked) {
        achievement.unlocked = true;
        showAchievementNotification(achievement);
        updateAchievementsDisplay();
        saveGame();
    }
}

function showAchievementNotification(achievement) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        background: linear-gradient(135deg, gold, orange);
        color: black;
        padding: 20px;
        border-radius: 10px;
        font-weight: bold;
        z-index: 1000;
        animation: slideIn 0.5s;
        box-shadow: 0 5px 20px rgba(255,215,0,0.5);
    `;
    notification.innerHTML = `
        <div style="font-size: 40px; margin-bottom: 10px;">${achievement.icon}</div>
        <div style="font-size: 18px;">Achievement Unlocked!</div>
        <div style="font-size: 16px;">${achievement.name}</div>
    `;
    document.body.appendChild(notification);
    
    playSound('achievement');
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

function updateAchievementsDisplay() {
    const sidebar = document.getElementById('achievementsSidebar');
    const list = document.getElementById('achievementsList');
    
    const html = achievements.slice(0, 6).map(a => `
        <div class="achievement ${a.unlocked ? 'unlocked' : ''}">
            <div class="achievement-icon">${a.icon}</div>
            <div class="achievement-name">${a.name}</div>
        </div>
    `).join('');
    
    const fullHtml = achievements.map(a => `
        <div class="achievement ${a.unlocked ? 'unlocked' : ''}">
            <div class="achievement-icon">${a.icon}</div>
            <div class="achievement-name">${a.name}</div>
            <div class="achievement-desc">${a.desc}</div>
        </div>
    `).join('');
    
    sidebar.innerHTML = html;
    if (list) list.innerHTML = fullHtml;
}

// Leaderboard
function updateLeaderboard() {
    const scores = JSON.parse(localStorage.getItem('diceGameLeaderboard') || '[]');
    
    if (gameState.score > 0) {
        scores.push({
            score: gameState.score,
            wins: gameState.wins,
            date: new Date().toLocaleDateString()
        });
        
        scores.sort((a, b) => b.score - a.score);
        scores.splice(10); // Keep top 10
        
        localStorage.setItem('diceGameLeaderboard', JSON.stringify(scores));
    }
    
    const leaderboardDiv = document.getElementById('leaderboardList');
    if (leaderboardDiv && scores.length > 0) {
        leaderboardDiv.innerHTML = scores.map((entry, i) => `
            <div class="leaderboard-entry">
                <div style="display: flex; align-items: center;">
                    <span class="leaderboard-rank">#${i + 1}</span>
                    <div>
                        <div class="leaderboard-score">${entry.score} points</div>
                        <div style="color: #888; font-size: 12px;">${entry.wins} wins ‚Ä¢ ${entry.date}</div>
                    </div>
                </div>
            </div>
        `).join('');
    } else if (leaderboardDiv) {
        leaderboardDiv.innerHTML = '<p style="color: #888;">No scores yet. Play a game to get on the leaderboard!</p>';
    }
}

function getHighScore() {
    const scores = JSON.parse(localStorage.getItem('diceGameLeaderboard') || '[]');
    return scores.length > 0 ? scores[0].score : 0;
}

// Share score
function shareScore() {
    const text = `üé≤ I scored ${gameState.score} points in Ultimate Dice Game! üé≤\n` +
                 `Wins: ${gameState.wins} | Win Streak: ${gameState.streak}\n` +
                 `Can you beat my score?`;
    
    if (navigator.share) {
        navigator.share({
            title: 'Ultimate Dice Game',
            text: text
        });
    } else {
        navigator.clipboard.writeText(text);
        showMessage('Score copied to clipboard!', 'win');
    }
}

// Confetti
function createConfetti() {
    for (let i = 0; i < 50; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * window.innerWidth + 'px';
            confetti.style.top = '-10px';
            confetti.style.backgroundColor = ['gold', 'red', 'blue', 'green', 'purple'][Math.floor(Math.random() * 5)];
            document.body.appendChild(confetti);
            
            setTimeout(() => confetti.remove(), 3000);
        }, i * 20);
    }
}

// Theme
function setTheme(theme) {
    document.body.className = theme + '-theme';
    document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    localStorage.setItem('diceGameTheme', theme);
}

// Load theme
const savedTheme = localStorage.getItem('diceGameTheme') || 'dark';
document.body.className = savedTheme + '-theme';

// Tabs
function showTab(tab) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    
    document.getElementById(tab + 'Tab').classList.add('active');
    event.target.classList.add('active');
}

// Keyboard controls
document.addEventListener('keydown', (e) => {
    if (e.key >= '1' && e.key <= '6') {
        pick(parseInt(e.key));
    } else if (e.key === ' ') {
        e.preventDefault();
        rollDice();
    } else if (e.key.toLowerCase() === 'r') {
        resetGame();
    } else if (e.key.toLowerCase() === 'u') {
        undoLast();
    }
});

// Sound effects
function playSound(type) {
    if (!gameState.soundEnabled) return;
    
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    if (type === 'roll') {
        oscillator.frequency.value = 200;
        gainNode.gain.value = 0.1;
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.1);
    } else if (type === 'win') {
        oscillator.frequency.value = 523.25; // C5
        gainNode.gain.value = 0.2;
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.2);
        
        setTimeout(() => {
            const osc2 = audioContext.createOscillator();
            const gain2 = audioContext.createGain();
            osc2.connect(gain2);
            gain2.connect(audioContext.destination);
            osc2.frequency.value = 659.25; // E5
            gain2.gain.value = 0.2;
            osc2.start();
            osc2.stop(audioContext.currentTime + 0.2);
        }, 100);
    } else if (type === 'lose') {
        oscillator.frequency.value = 200;
        gainNode.gain.value = 0.2;
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.3);
    } else if (type === 'pick') {
        oscillator.frequency.value = 400;
        gainNode.gain.value = 0.05;
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.05);
    } else if (type === 'powerup') {
        oscillator.frequency.value = 800;
        gainNode.gain.value = 0.1;
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.15);
    } else if (type === 'achievement') {
        [523.25, 659.25, 783.99].forEach((freq, i) => {
            setTimeout(() => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);
                osc.frequency.value = freq;
                gain.gain.value = 0.15;
                osc.start();
                osc.stop(audioContext.currentTime + 0.2);
            }, i * 100);
        });
    } else if (type === 'error') {
        oscillator.frequency.value = 150;
        gainNode.gain.value = 0.1;
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.2);
    }
}

function toggleSound() {
    gameState.soundEnabled = !gameState.soundEnabled;
    document.getElementById('soundBtn').textContent = gameState.soundEnabled ? 'üîä' : 'üîá';
}

// Daily challenge timer
function updateDailyChallenge() {
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setDate(tomorrow.getDate() + 1);
    tomorrow.setHours(0, 0, 0, 0);
    
    const diff = tomorrow - now;
    const hours = Math.floor(diff / 1000 / 60 / 60);
    const minutes = Math.floor((diff / 1000 / 60) % 60);
    const seconds = Math.floor((diff / 1000) % 60);
    
    document.getElementById('challengeTimer').textContent = 
        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')} remaining`;
}

setInterval(updateDailyChallenge, 1000);
updateDailyChallenge();

// Auto-save every 30 seconds
setInterval(saveGame, 30000);
</script>
</body>
</html>
